<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中文文本预处理技术详解 | 风控技术文档</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            color: #333;
            padding-top: 4rem;
            background-color: #f8f9fa;
        }

        .doc-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 3rem 0;
            margin-bottom: 2rem;
            border-radius: 0 0 15px 15px;
        }

        .doc-toc {
            position: sticky;
            top: 2rem;
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-bottom: 2rem;
        }

        .doc-content {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-bottom: 2rem;
        }

        .doc-section {
            margin-bottom: 3rem;
        }

        .doc-section h2 {
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            color: var(--primary-color);
        }

        .doc-section h3 {
            color: var(--secondary-color);
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }

        .code-block {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            overflow-x: auto;
            position: relative;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e9ecef;
        }

        .code-lang {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--secondary-color);
            background-color: rgba(52, 152, 219, 0.1);
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
        }

        .code-copy {
            background: none;
            border: none;
            color: #6c757d;
            cursor: pointer;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
        }

        .code-copy:hover {
            color: var(--secondary-color);
        }

        .code-copy.copied {
            color: var(--accent-color);
        }

        .image-container {
            text-align: center;
            margin: 2rem 0;
        }

        .image-container img {
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .image-caption {
            font-style: italic;
            color: #6c757d;
            margin-top: 0.5rem;
        }

        .note-box {
            background-color: #e8f4f8;
            border-left: 4px solid var(--secondary-color);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .warning-box {
            background-color: #fef3e2;
            border-left: 4px solid var(--accent-color);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .tag {
            display: inline-block;
            background-color: #e9ecef;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }

        .back-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--secondary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        .back-to-top.show {
            opacity: 1;
        }

        .performance-table {
            font-size: 0.9rem;
        }

        .performance-table th {
            background-color: var(--secondary-color);
            color: white;
        }

        .nav-breadcrumb {
            background-color: #f8f9fa;
            padding: 1rem 0;
            margin-bottom: 2rem;
            border-radius: 0 0 8px 8px;
        }

        @media (max-width: 768px) {
            .doc-toc {
                position: static;
                margin-bottom: 2rem;
            }
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="content-security-work.html">
                <i class="bi bi-arrow-left me-2"></i>返回工作记录
            </a>
        </div>
    </nav>

    <!-- 面包屑导航 -->
    <div class="nav-breadcrumb">
        <div class="container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb mb-0">
                    <li class="breadcrumb-item"><a href="index.html">首页</a></li>
                    <li class="breadcrumb-item"><a href="content-security-work.html">风控工作记录</a></li>
                    <li class="breadcrumb-item active">中文文本预处理</li>
                </ol>
            </nav>
        </div>
    </div>

    <!-- 文档头部 -->
    <header class="doc-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <span class="badge bg-light text-dark mb-2">技术文档</span>
                    <h1 class="display-5 fw-bold">中文文本预处理技术详解</h1>
                    <p class="lead">全面解析中文文本预处理的关键技术与实践应用</p>
                    <div class="d-flex flex-wrap mt-3">
                        <span class="tag">文本预处理</span>
                        <span class="tag">自然语言处理</span>
                        <span class="tag">内容安全</span>
                        <span class="tag">字符标准化</span>
                        <span class="tag">Python</span>
                    </div>
                </div>
                <div class="col-lg-4 text-lg-end">
                    <div class="text-white-50">
                        <p><i class="bi bi-calendar me-2"></i>发布日期: 2025年10月18日</p>
                        <p><i class="bi bi-person me-2"></i>作者: siriJR</p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="row">
            <!-- 文档目录 -->
            <div class="col-lg-3">
                <div class="doc-toc">
                    <h5>文档目录</h5>
                    <nav id="table-of-contents">
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link" href="#introduction">1. 引言</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#importance">2. 预处理的重要性</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#character-processing">3. 字符处理技术</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#special-processing">4. 特殊内容处理</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#implementation">5. 完整实现</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#application">6. 应用场景</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#conclusion">7. 总结</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>

            <!-- 文档内容 -->
            <div class="col-lg-9">
                <div class="doc-content">
                    <!-- 摘要 -->
                    <div class="alert alert-info">
                        <h5><i class="bi bi-info-circle"></i> 摘要</h5>
                        <p class="mb-0">本文详细介绍了中文文本预处理的关键技术，包括字符标准化、特殊符号处理、繁体转简体、拼音转换、表情符号处理以及业务特定内容识别等。通过系统化的预处理流程，可以有效提升后续NLP任务的准确性和效率。</p>
                    </div>

                    <!-- 1. 引言 -->
                    <section id="introduction" class="doc-section">
                        <h2>1. 引言</h2>
                        <p>在自然语言处理(NLP)和内容安全领域，文本预处理是至关重要的一步。特别是对于中文文本，由于存在繁简体、全半角、特殊符号、表情符号等多种复杂情况，预处理的质量直接影响后续分析任务的准确性和效率。</p>

                        <p>本文基于实际项目经验，系统性地介绍中文文本预处理的完整流程，包括字符标准化、特殊符号处理、繁体转简体、拼音转换、表情符号处理以及业务特定内容识别等关键技术。这些技术特别适用于内容安全、反垃圾、文本分类等场景。</p>

                        <div class="note-box">
                            <strong>适用场景:</strong> 中文文本预处理广泛应用于内容审核、情感分析、文本分类、搜索引擎、聊天机器人等多种NLP应用场景。
                        </div>
                    </section>

                    <!-- 2. 预处理的重要性 -->
                    <section id="importance" class="doc-section">
                        <h2>2. 预处理的重要性</h2>

                        <h3>2.1 提升模型性能</h3>
                        <p>良好的文本预处理可以显著提升NLP模型的性能：</p>
                        <ul>
                            <li><strong>减少噪声</strong>: 去除无关字符、符号和格式问题</li>
                            <li><strong>统一表示</strong>: 将不同形式的同一内容标准化</li>
                            <li><strong>增强泛化能力</strong>: 帮助模型更好地理解文本语义</li>
                        </ul>

                        <h3>2.2 应对中文特有挑战</h3>
                        <p>中文文本处理面临一些特有挑战：</p>
                        <ul>
                            <li><strong>字符编码多样性</strong>: 全角/半角、繁简体、特殊符号</li>
                            <li><strong>组合字符问题</strong>: Unicode组合符号导致的显示问题</li>
                            <li><strong>变体表达</strong>: 同音字、形近字、网络用语</li>
                            <li><strong>隐蔽联系方式</strong>: 刻意隐藏的微信、QQ等联系方式</li>
                        </ul>

                        <div class="image-container">
                            <div style="background:#f0f0f0; padding:2rem; border-radius:8px; text-align:center;">
                                <p>原始文本 → 字符标准化 → 特殊处理 → 业务处理 → 标准化输出</p>
                            </div>
                            <div class="image-caption">图1: 中文文本预处理流程示意图</div>
                        </div>
                    </section>

                    <!-- 3. 字符处理技术 -->
                    <section id="character-processing" class="doc-section">
                        <h2>3. 字符处理技术</h2>

                        <h3>3.1 全角转半角</h3>
                        <p>将全角字符转换为半角字符，统一字符表示：</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <button class="code-copy"><i class="bi bi-clipboard"></i> 复制</button>
                            </div>
                            <pre><code class="language-python">def sbcCase(self, text):
    """转换全角字符为半角字符"""
    return self.strtr(text, {
        "０": "0", "１": "1", "２": "2", "３": "3", "４": "4",
        "５": "5", "６": "6", "７": "7", "８": "8", "９": "9",
        'Ａ': 'A', 'Ｂ': 'B', 'Ｃ': 'C', 'Ｄ': 'D', 'Ｅ': 'E',
        # ... 更多字符映射
    })</code></pre>
                        </div>

                        <h3>3.2 特殊数字符号处理</h3>
                        <p>处理各种特殊数字表示形式：</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <button class="code-copy"><i class="bi bi-clipboard"></i> 复制</button>
                            </div>
                            <pre><code class="language-python">def circleCase(self, text):
    """转换①数字为半角数字"""
    return self.strtr(text, {
        "➀": "1", "➁": "2", "➂": "3", "➃": "4", "➄": "5",
        "➅": "6", "➆": "7", "➇": "8", "➈": "9", "①": "1",
        "②": "2", "③": "3", "④": "4", "⑤": "5", "⑥": "6",
        # ... 更多数字符号映射
    })</code></pre>
                        </div>

                        <h3>3.3 去除组合字符</h3>
                        <p>处理Unicode组合符号，解决显示异常问题：</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <button class="code-copy"><i class="bi bi-clipboard"></i> 复制</button>
                            </div>
                            <pre><code class="language-python">def dropUnicodeChar(self, text):
    """剔除组合字符--非常有用"""
    result = []
    for char in text:
        if char.isdigit():
            result.append(char)
        else:
            # 过滤所有Unicode组合符号
            category = unicodedata.category(char)
            if not category.startswith('M'):
                result.append(char)
    return ''.join(result)</code></pre>
                        </div>

                        <h3>3.4 繁体转简体</h3>
                        <p>将繁体中文转换为简体中文：</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <button class="code-copy"><i class="bi bi-clipboard"></i> 复制</button>
                            </div>
                            <pre><code class="language-python">def Traditional2Simplified(self, sentence):
    """转为简体"""
    sentence = Converter('zh-hans').convert(sentence)
    return sentence</code></pre>
                        </div>

                        <div class="note-box">
                            <strong>注意:</strong> 需要使用<code>langconv</code>库进行繁简转换，该库基于OpenCC实现，转换准确率高。
                        </div>
                    </section>

                    <!-- 4. 特殊内容处理 -->
                    <section id="special-processing" class="doc-section">
                        <h2>4. 特殊内容处理</h2>

                        <h3>4.1 表情符号处理</h3>
                        <p>将表情符号转换为可读的文本描述：</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <button class="code-copy"><i class="bi bi-clipboard"></i> 复制</button>
                            </div>
                            <pre><code class="language-python">def emojiCase(self, text, language='zh'):
    """
    输入：🚀🌕
    输出：火箭 满月
    """
    tmp = emoji.demojize(text, language=language)
    return tmp.replace(" ", "").replace(":", "")</code></pre>
                        </div>

                        <h3>4.2 业务特定内容识别</h3>
                        <p>识别和替换特定的业务内容：</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <button class="code-copy"><i class="bi bi-clipboard"></i> 复制</button>
                            </div>
                            <pre><code class="language-python">def specialBizCase(self, text):
    # 替换网络用语和变体表达
    text = self.strtr(text, {
        "yyds": "永远的神", "cnm": "操你妈", "sb": "傻b",
        "泡泡": "微信", "mm": "妹妹", "镁铝": "美女"
    })

    # 识别和替换联系方式
    # 手机号替换
    regex = re.compile("(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\\d{8}")
    text = re.sub(regex, "#手机号", text)

    # 邮箱替换
    regex = re.compile("[*#\\u4e00-\\u9fa5 a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)*\\.[a-zA-Z0-9]{2,6}")
    text = re.sub(regex, "#邮箱", text)

    return text</code></pre>
                        </div>

                        <h3>4.3 隐蔽联系方式检测</h3>
                        <p>检测变体联系方式，如刻意隐藏的微信/QQ：</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <button class="code-copy"><i class="bi bi-clipboard"></i> 复制</button>
                            </div>
                            <pre><code class="language-python">def detectStealthContact(self, text):
    """检测文本中是否包含变体联系方式"""
    # 匹配 "加微信" 变体
    wx = r'(?i)([加家珈伽甲贾➕＋✚]|%2[bB]|加[^a-zA-Z0-9]*?[微薇vV])[^a-zA-Z0-9]*?[微卫魏灰徽威尾薇vV✉️❤️❤🧡💛💚💙💜🖤💔❣💕💞💓💗💖💘💝💟xX]'

    # 匹配 "加QQ" 变体
    qq = r'(?i)([加家珈伽甲贾➕＋✚]|%2[bB]|加[^a-zA-Z0-9\u4e00-\u9fa5]*?[qQ])[^a-zA-Z0-9\u4e00-\u9fa5]*?[qQ🅀🆀🍬⒬ⓠ]'

    for match in re.finditer(wx, text):
        if match:
            return text + "#加微信"

    for match in re.finditer(qq, text):
        if match:
            return text + "#加qq"

    return text</code></pre>
                        </div>

                        <h3>4.4 拼音敏感词检测</h3>
                        <p>通过拼音检测潜在的敏感内容：</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <button class="code-copy"><i class="bi bi-clipboard"></i> 复制</button>
                            </div>
                            <pre><code class="language-python">def pinyinReplace(self, text):
    """检测拼音当中是否有敏感词"""
    textPingying = self.zh2pinyin(text)

    keyWords = {
        "meizi": "妹子", "koukou": "qq", "weixin": "微信",
        "cao": "操", "caonima": "操你妈", "nima": "你妈的"
    }

    for i in keyWords.keys():
        if textPingying.find(i) > -1:
            return text + "#pingyin:" + keyWords.get(i)
    return text</code></pre>
                        </div>
                    </section>

                    <!-- 5. 完整实现 -->
                    <section id="implementation" class="doc-section">
                        <h2>5. 完整实现</h2>

                        <h3>5.1 预处理主流程</h3>
                        <p>整合所有预处理步骤的完整实现：</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <button class="code-copy"><i class="bi bi-clipboard"></i> 复制</button>
                            </div>
                            <pre><code class="language-python">
    """完整的预处理流程"""
#! /usr/bin/env python3

import re
import emoji

import unicodedata
from .langconv import Converter
from .pinyinyLocal import PinyinyLocal

class TextPreprocess:

    def __init__(self):
        self.py = PinyinyLocal()


    #特定字符替换
    def strtr(self,text, replace):
        for s, r in replace.items():
            text = text.replace(s, r)
        return text

    # 中文转拼音
    def zh2pinyin(self,sentence):
        out = self.py.get_pinyin(sentence)
        return out

    # 转为简体
    def Traditional2Simplified(self,sentence):
        sentence = Converter('zh-hans').convert(sentence)
        return sentence

    # 转为繁体
    def Simplified2Traditional(self,sentence):
        sentence = Converter('zh-hant').convert(sentence)
        return sentence

    # 去除字母数字表情和其它字符
    def clear_character(self,text):
        pattern1 = '[a-zA-Z0-9]'
        pattern2 = '\[.*?\]'
        pattern3 = re.compile(u'[^\s1234567890:：' + '\u4e00-\u9fa5]+')
        pattern4 = '[’!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~]+'
        line1 = re.sub(pattern1, '', text)  # 去除英文字母和数字
        line2 = re.sub(pattern2, '', line1)  # 去除表情
        line3 = re.sub(pattern3, '', line2)  # 去除其它字符
        line4 = re.sub(pattern4, '', line3)  # 去掉残留的冒号及其它符号
        new_sentence = ''.join(line4.split())  # 去除空白
        return new_sentence


    def stopWordCase(self,text):
        """
        去掉停用词
        :param text:
        :return:
        """
        stopwords_dict = {
            '!': '',
            '.': '',
            ',': '',
            '#': '',
            '$': '',
            '%': '',
            '&': '',
            '*': '',
            '(': '',
            ')': '',
            '|': '',
            '?': '',
            '/': '',
            '@': '',
            '\'': '',
            '\'': '',
            ';': '',
            '[': '',
            ']': '',
            '{': '',
            '}': '',
            '+': '',
            '~': '',
            '-': '',
            '_': '',
            '=': '',
            '^': '',
            '<': '',
            '>': '',
            '　': '',
            '！': '',
            '。': '',
            '，': '',
            '￥': '',
            '（': '',
            '）': '',
            '？': '',
            '、': '',
            '“': '',
            '‘': '',
            '；': '',
            '【': '',
            '】': '',
            '——': '',
            '……': '',
            '《': '',
            '》': ''
        }
        return self.strtr(text, stopwords_dict)


    def sbcCase(self,text):
        """转换全角字符为半角字符
        SBC case to DBC case
        """
        return self.strtr(text, {
            "０": "0", "１": "1", "２": "2", "３": "3", "４": "4",
            "５": "5", "６": "6", "７": "7", "８": "8", "９": "9",
            'Ａ': 'A', 'Ｂ': 'B', 'Ｃ': 'C', 'Ｄ': 'D', 'Ｅ': 'E',
            'Ｆ': 'F', 'Ｇ': 'G', 'Ｈ': 'H', 'Ｉ': 'I', 'Ｊ': 'J',
            'Ｋ': 'K', 'Ｌ': 'L', 'Ｍ': 'M', 'Ｎ': 'N', 'Ｏ': 'O',
            'Ｐ': 'P', 'Ｑ': 'Q', 'Ｒ': 'R', 'Ｓ': 'S', 'Ｔ': 'T',
            'Ｕ': 'U', 'Ｖ': 'V', 'Ｗ': 'W', 'Ｘ': 'X', 'Ｙ': 'Y',
            'Ｚ': 'Z', 'ａ': 'a', 'ｂ': 'b', 'ｃ': 'c', 'ｄ': 'd',
            'ｅ': 'e', 'ｆ': 'f', 'ｇ': 'g', 'ｈ': 'h', 'ｉ': 'i',
            'ｊ': 'j', 'ｋ': 'k', 'ｌ': 'l', 'ｍ': 'm', 'ｎ': 'n',
            'ｏ': 'o', 'ｐ': 'p', 'ｑ': 'q', 'ｒ': 'r', 'ｓ': 's',
            'ｔ': 't', 'ｕ': 'u', 'ｖ': 'v', 'ｗ': 'w', 'ｘ': 'x',
            'ｙ': 'y', 'ｚ': 'z',
        })

    def circleCase(self,text):
        """转换①数字为半角数字
        ①②③④⑤⑥⑦⑧⑨⑩ case 全角
        ❹❸❽❼❽❼❾❽❼
        ➀➁➂➃➄➅➆➇➈
        """
        return self.strtr(text, {
            "➀": "1", "➁": "2", "➂": "3", "➃": "4", "➄": "5",
            "➅": "6", "➆": "7", "➇": "8", "➈": "9", "①": "1",
            "②": "2", "③": "3", "④": "4", "⑤": "5", "⑥": "6",
            "⑦": "7", "⑧": "8", "⑨": "9", "❶": "1", "❷": "2",
            "❸": "3", "❹": "4", "❺": "5", "❻": "6", "❼": "7",
            "❽": "8", "❾": "9", "➊": "1", "➋": "2", "➌": "3",
            "➍": "4", "➎": "5", "➏": "6", "➐": "7", "➑": "8",
            "➒": "9", 'Ⓐ': 'A', 'Ⓑ': 'B', 'Ⓒ': 'C', 'Ⓓ': 'D',
            'Ⓔ': 'E', 'Ⓕ': 'F', 'Ⓖ': 'G', 'Ⓗ': 'H', 'Ⓘ': 'I',
            'Ⓙ': 'J', 'Ⓚ': 'K', 'Ⓛ': 'L', 'Ⓜ': 'M', 'Ⓝ': 'N',
            'Ⓞ': 'O', 'Ⓟ': 'P', 'Ⓠ': 'Q', 'Ⓡ': 'R', 'Ⓢ': 'S',
            'Ⓣ': 'T', 'Ⓤ': 'U', 'Ⓥ': 'V', 'Ⓦ': 'W', 'Ⓧ': 'X',
            'Ⓨ': 'Y', 'Ⓩ': 'Z', 'ⓐ': 'a', 'ⓑ': 'b', 'ⓒ': 'c',
            'ⓓ': 'd', 'ⓔ': 'e', 'ⓕ': 'f', 'ⓖ': 'g', 'ⓗ': 'h',
            'ⓘ': 'i', 'ⓙ': 'j', 'ⓚ': 'k', 'ⓛ': 'l', 'ⓜ': 'm',
            'ⓝ': 'n', 'ⓞ': 'o', 'ⓟ': 'p', 'ⓠ': 'q', 'ⓡ': 'r',
            'ⓢ': 's', 'ⓣ': 't', 'ⓤ': 'u', 'ⓥ': 'v', 'ⓦ': 'w',
            'ⓧ': 'x', 'ⓨ': 'y', 'ⓩ': 'z',
            "㊀": "一", "㊁": "二", "㊂": "三", "㊃": "四",
            "㊄": "五", "㊅": "六", "㊆": "七", "㊇": "八",
            "㊈": "九",
        })

    def bracketCase(self,text):
        """转换⑴数字为半角数字
        ⑴ ⑵ ⑶ ⑷ ⑸ ⑹ ⑺ ⑻ ⑼case 全角
        """
        return self.strtr(text, {
            "⑴": "1", "⑵": "2", "⑶": "3", "⑷": "4", "⑸": "5",
            "⑹": "6", "⑺": "7", "⑻": "8", "⑼": "9",
            '🄐': 'A', '🄑': 'B', '🄒': 'C', '🄓': 'D', '🄔': 'E',
            '🄕': 'F', '🄖': 'G', '🄗': 'H', '🄘': 'I', '🄙': 'J',
            '🄚': 'K', '🄛': 'L', '🄜': 'M', '🄝': 'N', '🄞': 'O',
            '🄟': 'P', '🄠': 'Q', '🄡': 'R', '🄢': 'S', '🄣': 'T',
            '🄤': 'U', '🄥': 'V', '🄦': 'W', '🄧': 'X', '🄨': 'Y',
            '🄩': 'Z', '⒜': 'a', '⒝': 'b', '⒞': 'c', '⒟': 'd',
            '⒠': 'e', '⒡': 'f', '⒢': 'g', '⒣': 'h', '⒤': 'i',
            '⒥': 'j', '⒦': 'k', '⒧': 'l', '⒨': 'm', '⒩': 'n',
            '⒪': 'o', '⒫': 'p', '⒬': 'q', '⒭': 'r', '⒮': 's',
            '⒯': 't', '⒰': 'u', '⒱': 'v', '⒲': 'w', '⒳': 'x',
            '⒴': 'y', '⒵': 'z',
            "㈠": "一", "㈡": "二", "㈢": "三", "㈣": "四",
            "㈤": "五", "㈥": "六", "㈦": "七", "㈧": "八",
            "㈨": "九",
        })

    def dotCase(self,text):
        """转换⑴数字为半角数字
        ⒈⒉⒊⒋⒌⒍⒎⒏⒐case 全角
        """
        return self.strtr(text, {
            "⒈": "1",
            "⒉": "2",
            "⒊": "3",
            "⒋": "4",
            "⒌": "5",
            "⒍": "6",
            "⒎": "7",
            "⒏": "8",
            "⒐": "9",
        })

    def specialCase(self,text):
        """特殊字符比如希腊字符，西里尔字母
        """
        return self.strtr(text, {
            # 希腊字母
            "Α": "A", "Β": "B", "Ε": "E", "Ζ": "Z", "Η": "H",
            "Ι": "I", "Κ": "K", "Μ": "M", "Ν": "N", "Ο": "O",
            "Ρ": "P", "Τ": "T", "Χ": "X", "α": "a", "β": "b",
            "γ": "y", "ι": "l", "κ": "k", "μ": "u", "ν": "v",
            "ο": "o", "ρ": "p", "τ": "t", "χ": "x",

            # 西里尔字母 (U+0400 - U+04FF)
            "Ѐ": "E", "Ё": "E", "Ѕ": "S", "І": "I", "Ї": "I",
            "Ј": "J", "Ќ": "K", "А": "A", "В": "B", "Е": "E",
            "З": "3", "Ζ": "Z", "И": "N", "М": "M", "Н": "H",
            "О": "O", "Р": "P", "С": "C", "Т": "T", "У": "y",
            "Х": "X", "Ь": "b", "Ъ": "b", "а": "a", "в": "B",
            "е": "e", "к": "K", "м": "M", "н": "H", "о": "O",
            "п": "n", "р": "P", "с": "c", "т": "T", "у": "y",
            "х": "x", "ш": "w", "ь": "b", "ѕ": "s", "і": "i",
            "ј": "j",

            "À": "A", "Á": "A", "Â": "A", "Ã": "A", "Ä": "A", "Å": "A", "Ā": "A", "Ă": "A", "Ă": "A",
            "Ç": "C", "Ć": "C", "Ĉ": "C", "Ċ": "C",
            "Ð": "D", "Ď": "D", "Đ": "D",
            "È": "E", "É": "E", "Ê": "E", "Ë": "E", "Ē": "E", "Ė": "E", "Ę": "E", "Ě": "E",
            "Ĝ": "G", "Ġ": "G", "Ģ": "G",
            "Ĥ": "H", "Ħ": "H",
            "Ì": "I", "Í": "I", "î": "I", "ï": "I", "į": "I",
            "Ĵ": "J",
            "Ķ": "K",
            "Ļ": "L", "Ł": "L",
            "Ñ": "N", "Ń": "N", "Ņ": "N", "Ň": "N",
            "Ò": "O", "Ó": "O", "Ô": "O", "Õ": "O", "Ö": "O", "Ő": "O",
            "Ŕ": "R", "Ř": "R",
            "Ś": "S", "Ŝ": "S", "Ş": "S", "Š": "S", "Ș": "S",
            "Ţ": "T", "Ť": "T", "Ț": "T",
            "Ù": "U", "Ú": "U", "Û": "U", "Ü": "U", "Ū": "U", "Ŭ": "U", "Ů": "U", "Ű": "U", "Ų": "U",
            "Ŵ": "W",
            "Ý": "Y", "Ŷ": "Y", "Ÿ": "Y",
            "Ź": "Z", "Ż": "Z", "Ž": "Z",

            "à": "a", "á": "a", "â": "a", "ã": "a", "ä": "a", "å": "a", "ā": "a", "ă": "a", "ą": "a",
            "ç": "c", "ć": "c", "ĉ": "c", "ċ": "c",
            "ď": "d", "đ": "d",
            "è": "e", "é": "e", "ê": "e", "ë": "e", "ē": "e", "ė": "e", "ę": "e", "ě": "e", "ə": "e",
            "ĝ": "g", "ġ": "g", "ģ": "g",
            "ĥ": "h", "ħ": "h",
            "ì": "i", "í": "i", "î": "i", "ï": "i", "ī": "i", "į": "i",
            "ĵ": "j",
            "ķ": "k",
            "ļ": "l",
            "ñ": "n", "ń": "n", "ņ": "n", "ň": "n",
            "ò": "o", "ó": "o", "ô": "o", "õ": "o", "ö": "o", "ő": "o", "ŕ": "r", "ř": "r",
            "ś": "s", "ŝ": "s", "ş": "s", "š": "s", "ș": "s",
            "ţ": "t", "ť": "t", "ț": "t",
            "ù": "u", "ú": "u", "û": "u", "ü": "u", "ū": "u", "ŭ": "u", "ů": "u", "ű": "u", "ų": "u",
            "ŵ": "w",
            "ý": "y", "ŷ": "y", "ÿ": "y",
            "ź": "z", "ż": "z", "ž": "z",

            # 罗马数字Roman numerals
            "Ⅰ": "I", "Ⅱ": "II", "Ⅲ": "III", "Ⅳ": "IV", "Ⅴ": "V", "Ⅵ": "VI", "Ⅶ": "VII",
            "Ⅷ": "VIII", "Ⅸ": "IX", "Ⅹ": "X", "Ⅺ": "XI", "Ⅻ": "XII", "Ⅼ": "L", "Ⅽ": "C",
            "Ⅾ": "D", "Ⅿ": "M",
            "ⅰ": "i", "ⅱ": "ii", "ⅲ": "iii", "ⅳ": "iv", "ⅴ": "v", "ⅵ": "vi", "ⅶ": "vii",
            "ⅷ": "viii", "ⅸ": "ix", "ⅹ": "x", "ⅺ": "xi", "ⅻ": "xii", "ⅼ": "l", "ⅽ": "c",
            "ⅾ": "d", "ⅿ": "m",
        })

    def emojiCase(self,text, language='zh'):
        """
        输入：🚀🌕
        输出：火箭 满月  ': 虾 : : 鸡 : 8 见证'
        """
        tmp=emoji.demojize(text, language=language)
        return tmp.replace(" ","").replace(":","")

    def specialBizCase(self,text):
        #去空格
        regex = re.compile("\s+")
        text=re.sub(regex, " ", text.strip())
        #数字替换
        regex = re.compile("零|０|º|⁰|°|₀|０|⓿|⓪|0⃣️")
        text=re.sub(regex, "0",text)
        regex = re.compile("一|①|➀|⑴|⒈|❶|㈠|¹|₁|１|♳|⓵|I|1⃣️")
        text=re.sub(regex, "1",text)
        regex = re.compile("二|②|➁|⑵|⒉|❷|㈡|²|₂|２|♴|⓶|2⃣️")
        text=re.sub(regex, "2",text)
        regex = re.compile("三|③|➂|⑶|⒊|❸|㈢|³|₃|3|♵|⓷|3⃣️")
        text=re.sub(regex, "3",text)
        regex = re.compile("四|④|➃|⑷|⒋|❹|㈣|⁴|₄|４|♶|⓸|4⃣️")
        text=re.sub(regex, "4",text)
        regex = re.compile("五|⑤|➄|⑸|⒌|❺|㈤|⁵|₅|５|♷|⓹|5⃣️")
        text=re.sub(regex, "5",text)
        regex = re.compile("六|⑥|➅|⑹|⒍|❻|㈥|⁶|₆|6|♸|⓺|6⃣️")
        text=re.sub(regex, "6",text)
        regex = re.compile("七|⑦|➆|⑺|⒎|❼|㈦|⁷|₇|７|♹|⓻|7⃣️")
        text=re.sub(regex, "7",text)
        regex = re.compile("八|⑧|➇|⑻|⒏|❽|㈧|⁸|₈|８|⓼|8⃣️")
        text=re.sub(regex, "8",text)
        regex = re.compile("九|⑨|➈|⑼|⒐|❾|㈨|⁹|₉|９|⓽|9⃣️")
        text=re.sub(regex, "9",text)

        #特殊业务字符替换
        text=self.strtr(text, {
            "🅠": "q", "ⓠ": "q", "𝕢": "q", "ᑫ": "q", "𝐐": "q", "ǫ": "q",
            "٩": "q", "𝑄": "q", "ℚ": "q", "ꐎ": "q", "kou": "q",
            "\\+": "加", "➕": "加", "add": "加", "＋": "加", "jia": "加",
            "mm": "妹妹", "MM": "妹妹", "镁铝": "美女", "+": "加", "嘉v": "加微信",
            "yyds":"永远的神","cnm":"操你妈","sb":"傻b","泡泡":"微信"

        })

        #网址替换
        regex = re.compile("((https?|ftp|news):\\/\\/)?([a-z0-9]([a-z0-9\\-]*[\\.。])+([a-z]{2}|aero|arpa|biz|com|coop|edu|gov|info|int|jobs|mil|museum|name|nato|net|org|pro|travel)|(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))(\\/[a-z0-9_\\-\\.~]+)*(\\/([a-z0-9_\\-\\.]*)(\\?[a-z0-9+_\\-\\.%=&]*)?)?(#[a-z][a-z0-9_]*)?")
        text=re.sub(regex, "#网址", text)
        #手机号替换
        regex = re.compile("(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\\d{8}")
        text=re.sub(regex, "#手机号", text)
        #邮箱替换
        regex = re.compile("[*#\\u4e00-\\u9fa5 a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)*\\.[a-zA-Z0-9]{2,6}")
        text=re.sub(regex, "#邮箱", text)
        #QQ替换
        regex = re.compile("[1-9]([0-9]{8,12})")
        patternFilter = r'(\d)\1{3,}|(?:01234|12345|23456|34567|45678|56789|98765|87654|76543|65432|54321|43210)'
        if re.search(patternFilter,text):
            tmp=""
        else:
            text=re.sub(regex, "#QQ", text)

        # 微信号识别规则：6-20位，字母开头，排除纯英文单词
        wechat_pattern = r'^[a-zA-Z](?!.*(.)\1{3})(?=.*[\d_-])[a-zA-Z\d_-]{5,19}$'

        text=re.sub(wechat_pattern, '#微信', text)


        return text



    #检测拼音当中是否有敏感词
    def pinyinReplace(self,text):

        textPingying=self.zh2pinyin(text)

        keyWords={
            "meizi": "妹子", "koukou": "qq", "weixin": "微信", "jiawei": "加微信", "jiawo": "加我微信",
            "haowan": "好玩", "meizhi": "妹子", "meinv": "美女", "meilv": "美女", "ca": "操", "cao": "操", "qiuqiu": "qq",
            "keke": "qq","caonima":"操你妈","nima":"你妈的","kangkang":"看看","jiahui":"加微信"

        }
        for i in keyWords.keys():
            if textPingying.find(i)>-1:
                return text+"#pingyin:"+keyWords.get(i)
        return text


    #提取字符串当中的所有数字
    def extractNumberFromString(self,text):
        regex = re.compile("[0-9a-zA-Z_-]{6,}")
        result = re.search(regex, text)
        if result is not None:
            return result.group()
        else:
            return ""

    def remove_symbols_between_numbers(self,text):
        # 使用正则表达式匹配两两数字之间的符号
        pattern = r'(?<=\d)[\s\W]+(?=\d)'
        # 将匹配到的部分替换为空字符串
        result = re.sub(pattern, '', text)
        return result




    #剔除组合字符--非常有用
    def dropUnicodeChar(self,text):
        result = []
        for char in text:
            if char.isdigit():
                result.append(char)
            else:
                # 过滤所有Unicode组合符号（包括变音符号、注音符号等）
                category = unicodedata.category(char)
                if not category.startswith('M'):
                    result.append(char)  # 保留非组合的非数字字符（根据需求可选）
        return ''.join(result)

    def detectStealthContact(self,text):
        """
        检测文本中是否包含变体联系方式（如加微信/QQ等）
        返回匹配到的变体模式列表
        """
         # 匹配 "加微信" 变体（包含同音字、符号、组合等）
        wx = r'(?i)([加家珈伽甲贾➕＋✚]|%2[bB]|加[^a-zA-Z0-9]*?[微薇vV])[^a-zA-Z0-9]*?[微卫魏灰徽威尾薇vV✉️❤️❤🧡💛💚💙💜🖤💔❣💕💞💓💗💖💘💝💟xX]'

        # 匹配 "加QQ" 变体
        qq=  r'(?i)([加家珈伽甲贾➕＋✚]|%2[bB]|加[^a-zA-Z0-9\u4e00-\u9fa5]*?[qQ])[^a-zA-Z0-9\u4e00-\u9fa5]*?[qQ🅀🆀🍬⒬ⓠ]'

        # 匹配纯符号变体（如+V、+q等）
        qw= r'(?i)(➕|\+|＋|%2[bB])[^a-zA-Z0-9\u4e00-\u9fa5]*?[vVqQ]'


        # 匹配结果存储
        for match in re.finditer(wx, text):
            if match:
                return text + "#加微信"

        for match in re.finditer(qq, text):
            if match:
                return text + "#加qq"

        for match in re.finditer(qw, text):
            if match:
                return text + "#加qq微信"

        #检测字符串中所有的数字字母，是否有微信qq
        # 使用正则表达式匹配所有字母、下划线和数字
        pattern = r'(?<!\d)[\[({【（<※★]*(\d+)[\]})】）>※★]*(?!\d)'
        # 使用 findall 找出所有匹配的字符
        matches = re.findall(pattern, text)
        # 将匹配到的字符组合成一个新的字符串
        result = ''.join(matches)
        wechat_pattern = r'^[a-zA-Z](?!.*(.)\1{3})(?=.*[\d_-])[a-zA-Z\d_-]{5,19}$'

        if result!="":
            regex = re.compile("[1-9]([0-9]{8,12})")
            patternFilter = r'(\d)\1{3,}|(?:01234|12345|23456|34567|45678|56789|98765|87654|76543|65432|54321|43210)'
            if re.search(patternFilter, text):
                tmp = ""
            else:
                return text + "#加qq"

            if re.findall(wechat_pattern, result):
                return text + "#加微信"
        return text




    def preProcess(self,text):
        """抽出中文、英文、数字，忽略标点符号和特殊字符（表情）
        一般用与反垃圾
        """
        #全部转换为小写,去掉两边空格
        text = text.lower().strip()#.replace(" ","")
        #颜表情转换
        text = self.emojiCase(text)
        #简化组合字符
        text=self.dropUnicodeChar(text)
        #全角转半角
        text = self.sbcCase(text)
        text = self.circleCase(text)
        text = self.dotCase(text)
        text = self.bracketCase(text)
        text = self.specialCase(text)
        ## 去掉停用词
        #text = self.stopWordCase(text)
        #繁体转简体
        #text = self.Traditional2Simplified(text)
        #检测拼音当中是否有关键词--有些耗时
        #text = self.pinyinReplace(text)

        # 特殊业务字符
        text = self.specialBizCase(text)
        # 检测是否有加qq微信组合
        #text = self.detectStealthContact(text)




        return text


if __name__ == "__main__":
    #3⃕́̀4⃕́̀0⃕́̀1⃕́11111115⃕́̀haha哈加
    inptStr="⃕́̀4⃕́̀0⃕́̀1⃕́11111月小七 神【11】 VIP【33】【3】V 【4】问点紧张【3】刺激【7】的伽【1】"
    textRe=TextPreprocess()
    outputStr=textRe.preProcess(inptStr)
    print("输入：",inptStr,"\n")
    print("输出：", outputStr)

    t1=textRe.dropUnicodeChar(inptStr)
    t2=textRe.zh2pinyin(t1)</code></pre>
                        </div>

                        <h3>5.2 使用示例</h3>
                        <p>展示预处理类的使用方法：</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <button class="code-copy"><i class="bi bi-clipboard"></i> 复制</button>
                            </div>
                            <pre><code class="language-python"># 初始化预处理类
text_preprocess = TextPreprocess()

# 测试样例
test_cases = [
    "加🅠🅠12345678",
    "全新iPhone特价2999元！➕VX咨询",
    "今天的🌞天气真🚀不错",
    "①➁③全角数字测试",
    "聯繫我們了解更多信息"
]

# 处理每个样例
for text in test_cases:
    processed = text_preprocess.preProcess(text)
    print(f"原始: {text}")
    print(f"处理后: {processed}")
    print("-" * 50)</code></pre>
                        </div>

                        <h3>5.3 处理效果对比</h3>
                        <p>展示预处理前后的效果对比：</p>

                        <table class="table table-bordered performance-table">
                            <thead>
                                <tr>
                                    <th>原始文本</th>
                                    <th>处理后结果</th>
                                    <th>说明</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>加🅠🅠12345678</td>
                                    <td>加qq#手机号</td>
                                    <td>特殊QQ符号识别+手机号替换</td>
                                </tr>
                                <tr>
                                    <td>➕VX咨询最新产品</td>
                                    <td>加微信咨询最新产品#加微信</td>
                                    <td>隐蔽微信联系方式检测</td>
                                </tr>
                                <tr>
                                    <td>今天的🌞天气真🚀不错</td>
                                    <td>今天的大阳天气真火箭不错</td>
                                    <td>表情符号转文字</td>
                                </tr>
                                <tr>
                                    <td>①➁③全角数字测试</td>
                                    <td>123全角数字测试</td>
                                    <td>特殊数字符号标准化</td>
                                </tr>
                                <tr>
                                    <td>聯繫我們了解更多信息</td>
                                    <td>联系我们了解更多信息</td>
                                    <td>繁体转简体</td>
                                </tr>
                            </tbody>
                        </table>
                    </section>

                    <!-- 6. 应用场景 -->
                    <section id="application" class="doc-section">
                        <h2>6. 应用场景</h2>

                        <h3>6.1 内容安全与审核</h3>
                        <p>在内容安全领域，文本预处理可以帮助：</p>
                        <ul>
                            <li><strong>识别隐蔽广告</strong>: 检测变体联系方式、推广内容</li>
                            <li><strong>敏感信息过滤</strong>: 识别手机号、邮箱等个人信息</li>
                            <li><strong>违规内容检测</strong>: 通过拼音、变体识别敏感词</li>
                        </ul>

                        <h3>6.2 文本分类与聚类</h3>
                        <p>提升文本分类任务的准确性：</p>
                        <ul>
                            <li><strong>特征统一</strong>: 标准化不同形式的同一内容</li>
                            <li><strong>噪声去除</strong>: 减少无关字符对模型的影响</li>
                            <li><strong>语义增强</strong>: 表情符号转文字增加语义信息</li>
                        </ul>

                        <h3>6.3 搜索引擎优化</h3>
                        <p>改善搜索引擎的检索效果：</p>
                        <ul>
                            <li><strong>查询扩展</strong>: 繁简体、拼音等多种形式支持</li>
                            <li><strong>纠错能力</strong>: 处理常见的拼写错误和变体</li>
                            <li><strong>相关性提升</strong>: 更准确的文本匹配</li>
                        </ul>

                        <div class="note-box">
                            <strong>性能考虑:</strong> 在实际应用中，需要根据具体场景选择适当的预处理步骤，平衡处理效果和性能开销。
                        </div>
                    </section>

                    <!-- 7. 总结 -->
                    <section id="conclusion" class="doc-section">
                        <h2>7. 总结</h2>

                        <p>本文详细介绍了中文文本预处理的完整技术体系，涵盖了字符标准化、特殊符号处理、繁体转简体、表情符号处理、业务特定内容识别等关键技术。通过系统化的预处理流程，可以有效提升后续NLP任务的准确性和效率。</p>

                        <h3>7.1 技术要点总结</h3>
                        <p><strong>核心处理技术:</strong></p>
                        <ul>
                            <li>字符标准化：全角转半角、特殊符号处理</li>
                            <li>格式统一：繁体转简体、数字符号标准化</li>
                            <li>内容识别：联系方式、敏感信息检测</li>
                            <li>语义增强：表情符号转文字、拼音处理</li>
                        </ul>

                        <h3>7.2 最佳实践建议</h3>
                        <p>在实际应用中建议：</p>
                        <ul>
                            <li>根据业务需求定制预处理流程</li>
                            <li>建立持续更新的规则库和词典</li>
                            <li>平衡处理效果和性能开销</li>
                            <li>定期评估和优化预处理效果</li>
                        </ul>

                        <div class="note-box">
                            <strong>附件链接:</strong> https://github.com/siriJR/risk-content/tree/main/preProcess
                        </div>
                        <div class="note-box">
                            <strong>未来展望:</strong> 随着深度学习技术的发展，未来可以结合神经网络模型实现更智能的文本预处理，如基于上下文的字符标准化、语义驱动的变体识别等。
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </main>

    <!-- 返回顶部按钮 -->
    <a href="#" class="back-to-top">
        <i class="bi bi-arrow-up"></i>
    </a>

    <!-- 页脚 -->
    <footer class="bg-dark text-white py-5 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-6">
                    <h5>风控内容安全技术文档</h5>
                    <p>分享最前沿的内容安全技术与实践</p>
                </div>
                <div class="col-lg-6 text-lg-end">
                    <p>© 2025 风控技术团队. 保留所有权利.</p>
                    <p>
                        <a href="#" class="text-white me-2"><i class="bi bi-github"></i></a>
                        <a href="#" class="text-white me-2"><i class="bi bi-linkedin"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-envelope"></i></a>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        // 初始化代码高亮
        hljs.highlightAll();

        // 返回顶部按钮功能
        const backToTop = document.querySelector('.back-to-top');

        window.addEventListener('scroll', function() {
            if (window.pageYOffset > 300) {
                backToTop.classList.add('show');
            } else {
                backToTop.classList.remove('show');
            }
        });

        backToTop.addEventListener('click', function(e) {
            e.preventDefault();
            window.scrollTo({top: 0, behavior: 'smooth'});
        });

        // 代码复制功能
        document.querySelectorAll('.code-copy').forEach(button => {
            button.addEventListener('click', function() {
                const codeBlock = this.closest('.code-block');
                const code = codeBlock.querySelector('code').innerText;

                // 复制到剪贴板
                navigator.clipboard.writeText(code)
                    .then(() => {
                        // 显示复制成功反馈
                        const originalText = this.innerHTML;
                        this.innerHTML = '<i class="bi bi-check"></i> 已复制';
                        this.classList.add('copied');

                        // 2秒后恢复原始状态
                        setTimeout(() => {
                            this.innerHTML = originalText;
                            this.classList.remove('copied');
                        }, 2000);
                    })
                    .catch(err => {
                        console.error('复制失败:', err);
                    });
            });
        });
    </script>
</body>
</html>